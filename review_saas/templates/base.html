<!doctype html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}Reputation SaaS{% endblock %}</title>

  <!-- ======================= Fonts & Icons ======================== -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />

  <!-- ======================= Bootstrap 5.3 ======================== -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

  <!-- ======================= Global Styles ======================== -->
  <style>
    :root {
      --gradient-hero:
        radial-gradient(1200px 600px at 10% -10%, rgba(99,102,241,.20), transparent 60%),
        radial-gradient(1000px 500px at 110% 10%, rgba(16,185,129,.18), transparent 60%),
        linear-gradient(180deg, rgba(2,6,23,0), rgba(2,6,23,.06));
      --card-glass-bg: rgba(255,255,255,.65);
      --card-glass-border: rgba(255,255,255,.45);
      --shadow-soft: 0 12px 35px rgba(2,6,23,.08);
      --transition-fast: all .25s ease;
    }

    [data-bs-theme="dark"] {
      --card-glass-bg: rgba(13,17,23,.70);
      --card-glass-border: rgba(255,255,255,.08);
      --shadow-soft: 0 12px 35px rgba(0,0,0,.45);
    }

    html, body {
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial;
      scroll-behavior: smooth;
      background: var(--gradient-hero);
      min-height: 100vh;
    }

    .glass-card {
      background: var(--card-glass-bg);
      border: 1px solid var(--card-glass-border);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-soft);
      border-radius: 18px;
      transition: var(--transition-fast);
    }

    .glass-card:hover {
      transform: translateY(-2px);
    }

    .brand-gradient {
      background: linear-gradient(90deg,#6366f1,#10b981 60%,#06b6d4);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .nav-link {
      font-weight: 500;
      transition: var(--transition-fast);
    }

    .nav-link.active,
    .nav-link:hover {
      color: var(--bs-primary) !important;
    }

    .hero {
      border-radius: 22px;
      padding: 32px 26px;
      overflow: hidden;
      background:
        radial-gradient(600px 200px at 10% 20%, rgba(99,102,241,.18), transparent 60%),
        radial-gradient(600px 200px at 90% 20%, rgba(16,185,129,.18), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.25), rgba(255,255,255,.08));
      border: 1px solid var(--card-glass-border);
    }

    [data-bs-theme="dark"] .hero {
      background:
        radial-gradient(600px 200px at 10% 20%, rgba(99,102,241,.18), transparent 60%),
        radial-gradient(600px 200px at 90% 20%, rgba(16,185,129,.18), transparent 60%),
        linear-gradient(180deg, rgba(13,17,23,.65), rgba(13,17,23,.45));
    }

    .footer {
      border-top: 1px dashed var(--card-glass-border);
      backdrop-filter: blur(6px);
    }

    #toast-stack {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 1080;
    }
  </style>

  {% block head %}{% endblock %}
</head>

<body>

<!-- Prevent FOUC -->
<script>
(function () {
  try {
    const saved = localStorage.getItem('bsTheme') || 'light';
    document.documentElement.setAttribute('data-bs-theme', saved);
  } catch (_) {}
})();
</script>

<!-- ======================= Navbar ======================== -->
<nav class="navbar navbar-expand-lg sticky-top glass-card border-bottom py-2">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="/home">
      <span class="brand-gradient">Reputation SaaS</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navMain" class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">

        <li class="nav-item">
          <a class="nav-link px-3" href="/home">
            <i class="bi bi-house-door me-1"></i>Home
          </a>
        </li>

        <li class="nav-item">
          <a class="nav-link px-3" href="/ui/companies">
            <i class="bi bi-buildings me-1"></i>Companies
          </a>
        </li>

        <li class="nav-item me-lg-2">
          <a class="nav-link px-3" href="/ui/auth">
            <i class="bi bi-person-badge me-1"></i>Auth
          </a>
        </li>

        <li class="nav-item">
          <button id="themeToggle" class="btn btn-sm btn-outline-primary rounded-pill">
            <i class="bi bi-moon-stars"></i>
            <span class="ms-1 d-none d-sm-inline">Theme</span>
          </button>
        </li>

      </ul>
    </div>
  </div>
</nav>

<!-- ======================= Content ======================== -->
<div class="container my-4">
  {% block content %}{% endblock %}
</div>

<!-- ======================= Footer ======================== -->
<footer class="footer py-4 mt-5 glass-card">
  <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center small text-muted">
    <div>
      &copy; {{ (now() if now is defined) or '' }} Reputation SaaS â€” Crafted with
      <i class="bi bi-heart-fill text-danger"></i>
    </div>
    <div class="mt-2 mt-md-0">
      <a class="text-decoration-none me-3" href="#">Privacy</a>
      <a class="text-decoration-none me-3" href="#">Terms</a>
      <a class="text-decoration-none" href="#">Support</a>
    </div>
  </div>
</footer>

<!-- Toast Container -->
<div id="toast-stack" aria-live="polite" aria-atomic="true"></div>

<!-- ======================= JS Libraries ======================== -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous"></script>

<!-- Google Maps API (UNCHANGED) -->
<script defer src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API_KEY }}&libraries=places"></script>

<!-- ======================= Global JS ======================== -->
<script>
/* Theme Toggle */
(function () {
  const btn = document.getElementById('themeToggle');
  const apply = mode => document.documentElement.setAttribute('data-bs-theme', mode);
  const current = () => document.documentElement.getAttribute('data-bs-theme') || 'light';

  btn?.addEventListener('click', () => {
    const next = current() === 'dark' ? 'light' : 'dark';
    apply(next);
    try { localStorage.setItem('bsTheme', next); } catch (_) {}
  });
})();

/* Toast Utility */
window.showToast = function (title, body, variant = 'primary', delay = 3800) {
  const stack = document.getElementById('toast-stack');
  const el = document.createElement('div');
  el.className = 'toast align-items-center border-0 show mb-2';
  el.role = 'alert';

  el.innerHTML = `
    <div class="d-flex">
      <div class="toast-body">
        <span class="badge text-bg-${variant} me-2">&nbsp;</span>
        <strong>${title}</strong><br/>
        <span class="text-muted small">${body}</span>
      </div>
      <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast"></button>
    </div>
  `;

  stack.appendChild(el);
  setTimeout(() => el.remove(), delay + 500);
};
</script>

{% block scripts %}{% endblock %}
</body>
</html>
